# US 5.1.08

## 1. Context

The context of this US is to create patient profiles, which represents the individuals receiving medical care.

## 2. Requirements

### 2.1. User Story Description

- **US 5.1.08** As an Admin, I want to create a new patient profile, so that I can register their personal details and medical history.


### 2.2. Customer Specifications and Clarifications

> Question 1 - Email is Unique
>
> Q: How are duplicate patient profiles handled when registered by both the patient and admin?
>
> A: The system checks the email for uniqueness.
> 
> https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=31318

> Question 2 – MedicalRecordNumber and Date Format
>
> Q: So, when the administrator starts creating the patient profile, what format(s) of the date of birth will they need to enter? Furthermore, what will be the format of the Medical Record Number generated after recording the data?
>
> A: From a usability perspective, dates should be presented to the user using the operating system's locale definitions. since for this sprint you are building an API, you should use a standard format like ISO 8601. 
> Medical record numbers are generated by the system following the format YYYYMMnnnnnn where YYYY and MM are the year and month of the registration and nnnnnn is a sequential number
> 
> https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=31636


> Question 3 - Phone Number validation
>
> Q: What type contact information should we consider for the patient? just the phone number or more information?
>
> A: the contact information is the email, phone number,... phone numbers must allow for country code...
> 
> https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=31893

> Question 4 - Medical Record Number
>
> Q: O Medical Record Number dum Patient tem o formato yyyyMMnnnnnn, em que yyyy é o ano, MM é o mês e nnnnnn é um número sequencial. Esta sequência de números é igual para todos os meses? Ou será possível, por exemplo, ter um Patient com 202409000001 e outro com 202411000001.
>
> A: o numero sequencial é dependente do ano e mês. os dois exemplos dados ("202409000001 e outro com 202411000001") são válidos
> 
> https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=31963

> Question 5
>
> Q: It is specified that the admin can input some of the patient's information (name, date of birth, contact information, and medical history). 
> Do they also input the omitted information (gender, emergency contact and allergies/medical condition)? 
> Additionally, does the medical history that the admin inputs refer to the patient's medical record, or is it referring to the appointment history?>
>
> A: the admin can not input medical history nor allergies. they can however input gender and emergency contact
> 
> https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=31517

> Question 6
>
> Q: Numa das perguntas realizadas anteriormente, o cliente respondeu que o Admin não pode inserir o medical history. 
> No entanto, no caderno de encargos, nos critérios de aceitação da UC 5.1.8 está escrito o seguinte: "Admins can input patient details such as first name, last name, date of birth, contact information, and medical history.">
>
> A: considerem a formulaçao "Admins can input patient details such as first name, last name, date of birth and contact information", ignorando o medical history
>
> https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=31907


### 2.3 Acceptance Criteria

1. Admins can input patient details such as first name, last name, date of birth, contact information.
2. A unique patient ID (Medical Record Number) is generated upon profile creation.
3. The system validates that the patient’s email and phone number are unique.
4. The profile is stored securely in the system, and access is governed by role-based permissions.

### 2.5. Dependencies/References

* N/A

### 2.6. Input and Output Data

***Input Data:***
* Typed data:
  * Full name
  * Email
  * Phone number
  * Date Of Birth
  * Emergency Contact

* Selected data:
  * Gender (Male or Female)

***Output Data:***
* Success or failure of the operation


## 3. Analysis

### 3.1. Domain Model excerpt (DM)

![Patient_Aggregate.svg](Patient_Aggregate.svg)

## 4. Design

### 4.1. Realization

#### 4.1.1 Process view

##### 4.1.1.1 Level 1

![process_view_1.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FProcess%20View%2FxCreate%2Fprocess_view_1.svg)

##### 4.1.1.2  Level 2

![process_view_2.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FProcess%20View%2FxCreate%2Fprocess_view_2.svg)

##### 4.1.1.3  Level 3

![process_view_3.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FProcess%20View%2FxCreate%2Fprocess_view_3.svg)

#### 4.1.2 Logical view

##### 4.1.2.1 Level 1

![Logic_view_1.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FLogical%20View%2FLogic_view_1.svg)

##### 4.1.2.2  Level 2

![Logic_view_2.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FLogical%20View%2FLogic_view_2.svg)

##### 4.1.2.3  Level 3

![Logic_view_3.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FLogical%20View%2FLogic_view_3.svg)

#### 4.1.3 Cenário view

##### 4.1.3.1 Level 1

![scenarios_view_1.svg](..%2Fc4%20models%20with%20views%20-%20SPRINT1%2FScenarios%20View%2Fscenarios_view_1.svg)

### 4.2. Applied standards

The applied standards are:

- REST + ONION (architectural patterns);
- DTO;
- Persistence;
- Controller;
- Service;
- Interfaces;
- Scheme;
- Mapper;
- Repository;
- ORM.

### 4.3. Tests

**Domain Tests:** 

Domain tests are found in the class: Domain.Tests\PatientTest.cs

**E2E Tests:** *Verifies that *

E2E tests were performed in Postman.

**Integration Tests with isolation:** *Verifies that *

Integration tests are found in the class: WebApi.IntegrationTests\Tests\Patient

## 5. Integration/Demonstration

![Demonstration](../../../sem5pi-2425-3dl-69%20-%20Cópia%20(2)/Docs/US08/US08_Demonstration1.png)
![Demonstration](../../../sem5pi-2425-3dl-69%20-%20Cópia%20(2)/Docs/US08/US08_Demonstration2.png)

## 6. Observations

N/A